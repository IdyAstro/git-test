{% extends "base.html" %}

{% block content %}
<div class="p-6">

  <!-- Titre -->
  <h1 class="text-2xl font-bold text-[#005BAC] mb-6">ðŸ›’ Historique des approvisionnements</h1>

  <!-- Bouton nouvel approvisionnement -->
  <a href="{% url 'creer_appro' %}" 
     class="bg-[#005BAC] text-white px-4 py-2 rounded-lg shadow hover:bg-[#004080] transition flex items-center gap-2 w-fit">
     âž• Nouvel approvisionnement
  </a>

  <!-- Messages Django -->
  {% if messages %}
      <div class="mt-4 space-y-2">
          {% for message in messages %}
              <div class="
                  px-4 py-2 rounded-lg text-sm font-medium shadow-md
                  {% if message.tags == 'success' %}
                      bg-[#E6F0FA] text-[#005BAC] border border-[#B3D4F2]
                  {% elif message.tags == 'error' %}
                      bg-[#FDECEA] text-[#D93025] border border-[#F5C6CB]
                  {% endif %}
              ">
                  {{ message }}
              </div>
          {% endfor %}
      </div>
  {% endif %}

  <!-- Liste des approvisionnements -->
  <div class="mt-6 space-y-4">
    {% for appro in appros %}
      <div class="bg-white p-4 rounded-lg shadow border-l-4 border-[#F26F21]">
        <div class="flex justify-between items-center border-b pb-2 mb-2">
          <p class="font-semibold text-[#005BAC]">ðŸ“… {{ appro.date_appro|date:"d/m/Y H:i" }}</p>
          <span class="text-gray-600">ðŸ‘¤ {{ request.user }}</span>
        </div>
        <ul class="list-disc ml-6 space-y-1">
          {% for ligne in appro.appromateriel_set.all %}
            <li class="text-gray-700">{{ ligne.materiel }} â€” 
              <span class="font-bold text-[#F26F21]">{{ ligne.quantite }}</span>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% empty %}
      <p class="text-gray-500 italic">Aucun approvisionnement trouvÃ©.</p>
    {% endfor %}
  </div>

  <!-- Pagination -->
  <div class="flex justify-center items-center space-x-4 mt-6">
    {% if appros.has_previous %}
      <a href="?page={{ appros.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"
         class="px-4 py-2 bg-[#005BAC] text-white rounded-lg hover:bg-[#004080] transition">
         â¬… PrÃ©cÃ©dent
      </a>
    {% endif %}

    <span class="text-gray-700 font-semibold">
      Page {{ appros.number }} sur {{ appros.paginator.num_pages }}
    </span>

    {% if appros.has_next %}
      <a href="?page={{ appros.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}"
         class="px-4 py-2 bg-[#005BAC] text-white rounded-lg hover:bg-[#004080] transition">
         Suivant âž¡
      </a>
    {% endif %}
  </div>
</div>
{% endblock %}
